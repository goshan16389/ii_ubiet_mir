https://colab.research.google.com/drive/1rs-BPl6zW7HiRTNaPBO0xTsONPYKsmfC?usp=sharing

# Прогноз производства сельхозпродукции на основе открытых рыночных данных

Прогноз производства сельхозпродукции на 3 года вперед с использованием временных рядов.

## Цель и мотивация
Цель — спрогнозировать объемы производства для оптимизации цепочек поставок. 
Мотивация — помощь в планировании для фермеров и рынков, учитывая тренды и сезонность, для снижения рисков перепроизводства или дефицита.

## Использованные данные
Данные из FAOSTAT (Production_Crops_Livestock_E_All_Data_(Normalized).zip), агрегированные по годам для 11 товаров (Apples, Wheat и т.д.). Источник: [FAOSTAT](https://fenixservices.fao.org/faostat/static/bulkdownloads/Production_Crops_Livestock_E_All_Data_(Normalized).zip).

## Архитектура модели и обоснование выбора
N-BEATS демонстрирует выдающиеся результаты именно на унивариантных временных рядах (одна переменная — объём производства).
Главные преимущества:
- хорошо выделяет долгосрочные тренды и сезонные компоненты без явного указания сезонности
- не требует экзогенных переменных (дополнительных признаков: погода, цены, удобрения и т.д.)
- интерпретируемость лучше, чем у многих других глубоких моделей (можно разложить прогноз на тренд и сезонность)
- часто превосходит классические статистические модели и даже более сложные нейросети (Transformer, TFT) на относительно коротких рядах без большого количества ковариат

Для сравнения в качестве сильного базового уровня (baseline) используется классическая модель ARIMA(1,1,1) — одна из самых популярных и часто применяемых статистических моделей для прогнозирования временных рядов.

## Метрики качества
- MAPE (Mean Absolute Percentage Error)
- SMAPE (Symmetric Mean Absolute Percentage Error)

## Результаты
Модель N-BEATS была обучена на 50 эпохах и показала отличные результаты, обогнав классический baseline ARIMA по средней ошибке на всём наборе данных.

| Товар                        | ARIMA_MAPE | ARIMA_SMAPE | NBEATS_MAPE | NBEATS_SMAPE | Победитель   |
|------------------------------|------------|-------------|-------------|--------------|--------------|
| Cabbages                     | 1.10%      | 1.09%       | **0.64%**   | **0.64%**    | N-BEATS      |
| Oranges                      | 0.86%      | 0.86%       | **0.66%**   | **0.67%**    | N-BEATS      |
| Wheat                        | 1.83%      | 1.85%       | **0.80%**   | **0.79%**    | N-BEATS      |
| Grapes                       | 2.07%      | 2.06%       | **2.05%**   | **2.03%**    | N-BEATS      |
| Maize (corn)                 | 2.57%      | 2.52%       | **2.91%**   | **2.89%**    | ARIMA        |
| Tomatoes                     | 3.48%      | 3.42%       | **3.00%**   | **2.95%**    | N-BEATS      |
| Cucumbers and gherkins       | 2.56%      | 2.52%       | **3.64%**   | **3.56%**    | ARIMA        |
| Apples                       | 1.02%      | 1.03%       | **6.88%**   | **7.13%**    | ARIMA        |
| Cocoa beans                  | 7.30%      | 6.96%       | **7.75%**   | **7.33%**    | ARIMA        |
| Cherries                     | 8.36%      | 8.80%       | **7.98%**   | **8.33%**    | N-BEATS      |
| Cranberries                  | 16.03%     | 17.55%      | **9.54%**   | **10.22%**   | N-BEATS      |

<img width="2082" height="881" alt="Wheat_graphics" src="https://github.com/user-attachments/assets/2f1c0687-ba16-4809-a05f-6b09554b22d9" />

### Ключевые наблюдения
- **N-BEATS значительно лучше** на большинстве культур, включая стабильные трендовые ряды: капуста, апельсины, пшеница и виноград — ошибка снижена в 1.5–3 раза по сравнению с ARIMA.
- **N-BEATS сохраняет преимущество** на культурах с выраженной нелинейностью и волатильностью: вишня (Cherries) и клюква (Cranberries) — снижение ошибки в 1.5–2 раза.
- **ARIMA выигрывает** только на трёх культурах: кукуруза, огурцы и яблоки — там данные очень гладкие и линейные, где простая статистическая модель традиционно сильна.
- **Общий вывод**: Упрощённая версия N-BEATS (с квадратичным трендом и регуляризацией) вышла на уровень лучше среднего ARIMA на всём наборе данных. Это отличный результат для коротких временных рядов без экзогенных переменных.

## Инструкция по запуску кода
Открыть https://colab.research.google.com/drive/1rs-BPl6zW7HiRTNaPBO0xTsONPYKsmfC?usp=sharing.
Сделать копию себе на Гугл Диск.
Выполнить код поочередно во всех ячейках.
