https://colab.research.google.com/drive/1rs-BPl6zW7HiRTNaPBO0xTsONPYKsmfC?usp=sharing

# Прогноз спроса на сельхозпродукцию на основе открытых рыночных данных

Прогноз производства сельхозпродукции (11 товаров) на 3 года вперед с использованием временных рядов.

## Цель и мотивация
Цель — спрогнозировать объемы производства для оптимизации цепочек поставок. 
Мотивация — помощь в планировании для фермеров и рынков, учитывая тренды и сезонность, для снижения рисков перепроизводства или дефицита.

## Использованные данные
Данные из FAOSTAT (Production_Crops_Livestock_E_All_Data_(Normalized).zip), агрегированные по годам для 11 товаров (Apples, Wheat и т.д.). Источник: [FAOSTAT](https://fenixservices.fao.org/faostat/static/bulkdownloads/Production_Crops_Livestock_E_All_Data_(Normalized).zip).

## Архитектура модели и обоснование выбора
N-BEATS демонстрирует выдающиеся результаты именно на унивариантных временных рядах (одна переменная — объём производства).
Главные преимущества:
- хорошо выделяет долгосрочные тренды и сезонные компоненты без явного указания сезонности
- не требует экзогенных переменных (дополнительных признаков: погода, цены, удобрения и т.д.)
- интерпретируемость лучше, чем у многих других глубоких моделей (можно разложить прогноз на тренд и сезонность)
- часто превосходит классические статистические модели и даже более сложные нейросети (Transformer, TFT) на относительно коротких рядах без большого количества ковариат

Для сравнения в качестве сильного базового уровня (baseline) используется классическая модель ARIMA(1,1,1) — одна из самых популярных и часто применяемых статистических моделей для прогнозирования временных рядов.

## Метрики качества
- MAPE (Mean Absolute Percentage Error)
- SMAPE (Symmetric Mean Absolute Percentage Error)

## Результаты
Модель N-BEATS была обучена на 80 эпохах и показала смешанные, но в целом очень достойные результаты по сравнению с классическим baseline ARIMA(1,1,1).

| Товар                        | ARIMA_MAPE | ARIMA_SMAPE | NBEATS_MAPE | NBEATS_SMAPE |
|------------------------------|------------|-------------|-------------|--------------|
| Cherries                     | 8.36%      | 8.80%       | **2.82%**   | **2.89%**    |
| Apples                       | **1.02%**  | **1.03%**   | 2.99%       | 2.95%        |
| Cranberries                  | 16.03%     | 17.55%      | **5.81%**   | **5.99%**    |
| Maize (corn)                 | **2.57%**  | **2.52%**   | 6.06%       | 5.82%        |
| Wheat                        | **1.83%**  | **1.85%**   | 6.07%       | 5.80%        |
| Cabbages                     | **1.10%**  | **1.09%**   | 6.85%       | 6.51%        |
| Oranges                      | **0.86%**  | **0.86%**   | 7.96%       | 7.53%        |
| Cucumbers and gherkins       | **2.56%**  | **2.52%**   | 8.32%       | 7.88%        |
| Tomatoes                     | **3.48%**  | **3.42%**   | 8.38%       | 8.00%        |
| Grapes                       | **2.07%**  | **2.06%**   | 8.93%       | 8.35%        |
| Cocoa beans                  | **7.30%**  | **6.96%**   | 15.42%      | 13.95%       |

<img width="2082" height="881" alt="Cherries_graphics" src="https://github.com/user-attachments/assets/6c2183b9-26bf-4a2a-b578-718a1e3981c4" />


**Ключевые наблюдения:**
- **N-BEATS значительно лучше** на культурах с выраженной нелинейностью и нестационарностью: вишня (Cherries) и клюква (Cranberries) — снижение ошибки более чем в 2–3 раза.
- **ARIMA неожиданно выигрывает** на многих стабильных трендовых рядах (пшеница, апельсины, томаты, виноград, какао и др.), где данные довольно гладкие и хорошо описываются линейными/полиномиальными трендами + дифференцированием.
- Средняя MAPE по всем культурам:  
  ARIMA ≈ **4.2–4.5%**, N-BEATS ≈ **7.0–7.5%** (но с гораздо лучшими результатами на сложных рядах).

## Инструкция по запуску кода
Открыть https://colab.research.google.com/drive/1rs-BPl6zW7HiRTNaPBO0xTsONPYKsmfC?usp=sharing.
Сделать копию себе на Гугл Диск.
Выполнить код поочередно во всех ячейках.
